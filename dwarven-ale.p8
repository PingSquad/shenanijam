pico-8 cartridge // http://www.pico-8.com
version 8
__lua__
game_started_at = time()
old_seed = 0
wood_flipped = 0

lvl={
 {bottom=120},
 current=1
}

t=0

grav=1

debug = {f=function()end}

function _init()
 init_table()
 init_cauldron()
 init_foot()
 init_wood()
 init_knife1()
 init_particle_gen()
 init_meter()
end

function _update()
 t+=1
 update_knife1()
 update_foot()
 update_wood()
 table:update()
 update_particle_gen()
end

function _draw()
 cls()
 cauldron:draw()
 table:draw()
 draw_wood()
 draw_fungus()
 draw_foot()
 --draw_meter({'yeast',9},114,64,false,7) --7
 --draw_meter({'blood',8},122,64+20,true,3,40) --15
 draw_meter({'yeast',9},64-3,64,false,7)
 draw_meter({'blood',8},64+5,64+20,true,3,40)
 debug.f()
 rectfill(49,0,128,128,0)
 cs = {2,8,14}
 for x=49,130 do
  ci = flr( abs( sin(x/28 + ((x)%2)/(cos(x*.0016)*2) )*(#cs-1) ) )+1

  c = cs[ci]
  line(x+sin(t/400)*1.3,0,x+sin(t/400)*1.3,127,c)
 end
 draw_knife1()
 draw_particle_gen()
end

-- objects

-- foot
function init_foot()
 foot={
  x=101,
  rest_x=101,
  y=20,
  bw=8*2+4,
  bh=8*7+3,
  w=8*3.7,
  h=8*11,
  offx=0,
  offy=0,
  speed=200,
  hit_off=0,
  dx=0,
  max_dx = 10,
  grav=-1,
  dec=.9,
  blood_spouts={}
 }
 init_fungus()
 for i=0,4000 do
  update_fungus()
 end
end

function update_foot()
 f = foot
 s=f.speed
 f.dx *= f.dec
 f.dx += f.grav
 f.dx = mid(-f.max_dx/2, f.dx, f.max_dx)
 if wood_flipped != 4 then
  f.offy = sin(t/s/2-s/21)*5


  --f.x += f.dx 
  --f.x = max(f.rest_x, f.x)
 
  f.offx = max( sin(t/s)*1.3, f.offx+f.dx )
 else
  f.offy = sin(t/27)*5
  f.offx = max( wood.x-foot.x+wood.w/2 + sin(t/15)*2.3, 
               f.offx+f.dx*.7)
 end

 update_fungus()
 for bf in all(f.blood_spouts) do 
  bf:update()
  if bf.hp <= -20 then
   --we can remove while iterating
   del(f.blood_spouts, bf)
  end
 end
 -- debug.f=function()
 --  print(#foot.blood_spouts,0,0,7)
 --  y=0
 --  for bs in all(foot.blood_spouts) do 
 --   print('hp:'..bs.hp..' #:'..#bs.drops,0,bs.y,7)
 --  end
 -- end
end

-- spouts blood
-- retracts
function cut_foot(x,y)
 x = flr(x-foot.offx)
 y = flr(y-foot.offy)
 if x < foot.x or y < foot.y or y > foot.y+foot.h then
  return
 end
 foot.dx = foot.max_dx
 add(foot.blood_spouts, 
     make_blood_fountain(x+1,y+1,
                         -rnd(10),rnd(2)-1,
                         rnd(200)+1,40))

end

function draw_foot()
 rectfill(foot.x+foot.offx+foot.w/2,
  foot.y+foot.offy+foot.h-33,
  foot.x+foot.offx+foot.w*2,
  foot.y+foot.offy+foot.h-23,4) 
 all_to_color(2)
 draw_foot_here(foot.x+17+foot.offx/3,
                foot.y+5+foot.offy/4,
                .94)
 all_to_color()
 all_to_color(1)
 draw_foot_here(foot.x+foot.offx+1,
                foot.y+foot.offy)
 all_to_color()
 all_to_color(1)
 draw_foot_here(foot.x+foot.offx,
                foot.y+foot.offy+1)
 all_to_color()
 if foot.dx > 0 then
  all_to_color(7)
  draw_foot_here()
  all_to_color()
 else
  draw_foot_here()
 end

 for bf in all(f.blood_spouts) do 
  bf:draw()
 end
end

function draw_foot_here(x,y,s)
 s = s or 1
 sspr(8,0,
 				 foot.bw,foot.bh,
 					x or foot.x+foot.offx,
 					y or foot.y+foot.offy,
 					foot.w*s,foot.h*s)
end

function init_wood()
 wood = {
  x=2,
  y=0,
  dy=3,
  w=32,
  gfx = unpack_graphics('aaaaaaaa44aaaaaaaaaaaaaaaaaa4aaaaaaaaaa44aaaaaaaaaaaaaaaaaa44aaaaaaaaa44aaaaaaaaaaaaaaa44444aaaaaaaa444aaaaaaaaaaaaaa444aaaaaaaaaa444aaaaaaaaaaaaa444aaaaaaaaaaa44aaaaaaaaa44444444aaaaaaaaaaaaaaaaaaaaaaa44aaaaaaaaaaaaaaaaaaaaaaaaaaa444aaaaaaaaaaaaaaaaaaaaaaaaaaa444aaaaaaaaaaaaaaaaa4444444aaaa44aaaaaaaa44444444444aaaaaaaa4444aaaaaaaa44aaaaaaaaaaaaaaaaa44aaaaaaaaa44aaaaaaaaaaaaaaaaaaaaaaaaaaa4444aaaaaaaaaaaaaaaaaaaaaaaaaaa44aaaaaaaaaaa444444444444aaaaa44aaaaaaaaa4444aaaaaaaaaaaaaaa444aaaaaaaa44aaaaaaaaaaaaaaaaa44aaaaaaaaaa4aaaaaaaaaaaaaaaaaa44aaaaaaaa444aaaaaaaaaaaaaaa4444aaaaaaaaa44aaaaaaaaaaaaaaaa44aaaaaaaaaa444aaaaaaaaaaaaaaaa44aaaaaaaaaa44aaaaaaaaaaaaaaaa444aaaaaaaaaa44aaaaaaaaaaaaaaa444aaaaaaaaaaa44aaaaaaaaaaaaa4444aaaaaaaaaaa44aaaaaaaaa4444444aaaaaaaaaa4444aaaaaaaa4444aaaaaaaaaaaaaa44994aaaaaa4444aaaaaaaaaaaaaaa44999aaaaaa444aaaaaaaaaaaaaaa444999aaaaaaa44aaaaaaaaaaaaaaa444999aaaaaaaaa4aaaaaaaaaaaaaaa49999aaaaaaaaaa44aaaaaaaaa44444499aaaaaaaaaaaa44aaaaaa4444999999aaaaaaaaaa99a44aaaaaa44999aaaaaaaaaaaaaaaa44a4aaaaaaa499aaaaaaaaaaaaaaaa944944aaaaaa449aaaaaaaaaaaaaaaa994994aaaaaaa499aaaaaaaaaaaaaaa99449aaaaaaaa449aaaaaaaaaaaaaa9944449aaaaaaaa49aaaaaaaaaaaaa99444499aaaaaaaaa49aaaaaaaaa99999444499aaaaaaaaaa49aaaaaa9999444444499aaaaaaaaaa449aaaa99944444444999aaaaaaaaaa499aaaa9944444444499aaaaaa9aaaa449aaaaa944444444449aaaaaa99aaaa499aaaa9944499994449aaaaa944aaa449aaaaa944499aa94499aaaa944aaa4999aaaaa94449aa99449aaaa944aaa4499aaaaa9944499994449aaaa44aaa4999aaaaaa9944444444499aaa44aaaa499aaaaaa9944444444499aaaa94aaaa9aaaaaaa9944449999999aaaa944aaaaaaaaaaaa9444999aaaaaaaaaa994aaaaaaaaaaa994499aaaaaaaaaaaa944aaaaaaaaaaa94499aaaaaaaaaaaaa44aaaaaaaaaaa94499aaaaaaaaaaaaa94aaaaaaaaaaaa9449aaaaaaaaaaaaa444aaaaa4aaaaa9449aaaaaaaaaaaa994aaaaaaa4aaaaa9449aaaaaaaaaa99944aaaaa444aaaa94499aaaaaaa9444444aaaaaa44aaaaa9449aaaaaaa9444aaaaaaaaaa4aaaaa94449aaaaaa944aaaaaaaaaaa44aaaaa94499aaaaa944aaaaaaaaaaa44aaaaaa9449aaaaa944aaaaaaaaaaa44aaaaaaa4499aaaa944aaaaaaaaaaa44aaaaaaaa449aaaaa949aaaaaaaaa44aaaaaaaaaa449aaaaa44aaaaaaaa44aaaaaaaaa'
                        ,32),
  --falling=true,
  flipping=false,
  was_cut=false,
  flip=function(s)
   if(not s.flipping)s.dy=-6
   s.flipping=true
  end
 }
 wood.h = wood.gfx.h
 wood.y = -wood.h
end


function update_wood()
 w = wood 
 w.dy += grav
 w.y += w.dy 
 b = table.y-w.h + table.depth*table.oy
 if w.y > b then
  table.dy = w.dy/5
  w.dy *= -.5
 end
 w.y = min(w.y+w.dy,flr(b))

 --flipping
 if w.flipping then
  w.w-=4
  w.w = max(-w.gfx.w, w.w)
  if w.w == -w.gfx.w then -- done flipping
   flip_graphics(w.gfx)
   w.w=w.gfx.w
   w.flipping = false
   wood_flipped += 1
   change_color = false
   if wood_flipped == 2 then 
    w.dy -= 5
    change_color = {14}--,14,14,14,2,8,14,14}--,14,2,14,2}
   end   
   if wood_flipped == 4 then 
    w.dy -= 6
    change_color = {11}--,11,11,11,3,10,11,11}
   end
   if change_color then
    for y=1,w.gfx.h do for x=1,w.gfx.w do
     c = change_color[(x+y)%#change_color+1]
     if (w.gfx[y][x] != 0) w.gfx[y][x] = c
    end end
   end
  end
 end
end

function cut_wood(x,y)
 w = wood
 x-=2
 if(not intersects_point_box(x,y,w.x,w.y,w.w,w.h))return
 g = w.gfx
 ln = g[flr(y-w.y+1)]

 -- clear wood
 for px=flr(x),w.x+w.w do
  op = ln[px] 
  ln[px]=0
  if op != 0 and op != nil then
   dx=rnd(4)+1
   dk=rnd(3)+1
   sc=dx>4 and 1 or 2
   for d in all({{1,1},{1,0},{0,1}}) do
    add(particles,
    make_particle(
     px+d[1],y-d[2],
     dx/2,
     0,
     --rnd(1)-.5,
     sc,10,dk
    ))
   end
   add(particles,
    make_particle(
     px,y,
     dx,
     0,
     --rnd(1)-.5,
     op,10,dk
   ))
  end
 end
 -- slow down knife if a hit
 if op != 0 then
  w.was_cut=true
  knife1.dy=min(knife1.dy,knife1.max_dy*.85*(1+rnd(1.5)-.75))
  -- gritty difficulty
  knife1.dx*=1+rnd(.4)-.2
 end
end

function draw_wood()
 w = wood

 all_to_color(2)
 draw_graphics(w.gfx,
  w.x+2 +w.gfx.w/2 - w.w/2,w.y+table.oy,
  w.w/w.gfx.w)
 all_to_color()

 g = {w.gfx[1],w=w.w,h=1}
 all_to_color(4)
 draw_graphics(g,
  w.x+2 +w.gfx.w/2 - w.w/2,w.y+table.oy,
  w.w/w.gfx.w)
 all_to_color()

 draw_graphics(w.gfx,
  w.x +w.gfx.w/2 - w.w/2,w.y,
  w.w/w.gfx.w)
end

function init_cauldron()
 cauldron={
  x=45,
  y=lvl[1].bottom-8,

  gfx=unpack_graphics(
   '0000000000000000000000dddddddddddddd00000000000000000000000000000000005555dd55555555555555555550555550000000000000000005555555555555555555555555555555555555555555d55000000000055d555555555555555555555555555555555555555555555550000055d55555555555555555555555555555555555555555555555d550000555555555555555555555555eeeee5555555555555555555555650000555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeee5eee5555555555500055555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee5555550005555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee555555500005555555555555555555eeeeeeeeeee5555555555d555555555555000005555555555555555dd5e55ddddd55555ddddddd5ddd5555555500000055555555555555555555555555555555555555555555555555100000005555555555555555555555555555555555555555555555511000000005515555555555555555555555555555555555555555551111000000055555555551155555555555555551515155111151111161111500000555555555555555555111111111111111115155556666665555550000555555555555555555555555111111111151511555555555555500000555555555555555555555555555555555555555555555555555555005555555555555555555555555555555555555155155555555555555005555555677555555555555555555555555555555555555555dd5555505555555666777765555555555555555555555555555555ddd55d5550555555555666666666666666665555555555555555555555555555511155555555555555555555555555555555555555555555555555511155515555555555555555555555555555555555555555555555555555551551155155555555555555555555555555555555555555555555555115555511511155555555555555555555555555555555555555551111555555555555555555555555555555555555555555555555555555555555'
   ,57
   --'000000000005555dd55555555555555555550555550000000000000005555555555555555555555555555555555555555555555000000055d555555555555555555555555555555555555555555555550055d555555555555555555555555555555555555555555555555550555555555555555555555555eeeee5555555555555555555555550555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeee5eee5555555555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee5555555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee555555505555555555555555555eeeeeeeeeee55555555555555555555555005555555555555555555e555555555555555555555555555555500055555555555555555555555555555555555555555555555555100005555555555555555555555555555555555555555555555511000005515555555555555555555555555555555555555555551111000055555555551155555555555555551515111111151111161111500555555555555555555111111111111111115155556666665555550'
   --'000000000005555dd55555555555555555550555550000000000000005555555555555555555555555555555555555555555555000000055d555555555555555555555555555555555555555555555550055d555555555555555555555555555555555555555555555555550555555555555555555555555eeeee5555555555555555555555550555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeee5eee5555555555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee55555555555555eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee5555555505555555555555555555eeeeeeeeeee55555555555555555555555005555555555555555555e555555555555555555555555555555500055555555555555555555555555555555555555555555555555100005555555555555555555555555555555555555555555555511000005515555555555555555555555555555555555555555551111000055555555551155555555555555551515111111151111161111500555555555555555555111111111111111115155556666665555550'
   --,54
   ),
  draw=function(s)
   draw_graphics(s.gfx,s.x,s.y,1.5)
  end
 }
end

function init_table()
 table = {
  x=-30,
  y=100,
  rest_y=100,
  dy=0,
  rest_dy=-2,
  grav=-.5,
  w=62,
  h=16,
  ox=1.3,
  oy=-.5,
  depth=10,
  update=function(s)
   s.dy += s.grav
   s.dy = max(s.dy,s.rest_dy)

   s.y += s.dy
   s.y = max(s.y,s.rest_y)
  end,
  draw=function(s)
   fc = 9
   cs = {4,4,2,1}
   tcs = {9,4,2}

   -- leg
   x=s.x+s.w/2
   y=s.y+s.h/2
   rectfill(x+s.w/4-1,y,x+s.w/4,140,1)
   rectfill(x,y,x+s.w/4-1,140,2)
   rectfill(x+1,s.y+s.h+3,x+s.w/4-3,140,4)
   rectfill(x+4,s.y+s.h+4,x+5,140,9)
   for i=0,s.depth do
    r = s.depth-i
    c = get_arr_section(cs, s.depth, r)
    x = s.x+s.ox*r
    y = s.y+s.oy*r
    rectfill(x,y,x+s.w,y+s.h,c)
    tc = get_arr_section(tcs, s.depth, r)
    rectfill(x,y,x+s.w,y,tc)
   end
   rectfill(s.x,s.y,s.x+s.w,s.y+s.h,fc)
  end
 }
end

-- fungus
function init_fungus()
 fungus_colors = {10,11,3}
 fungus_grow_speed = 10
 fungus_seed = rnd(128)
 fungus = {}
 fungus_max_length = 15
 
 -- get foot outline
 cls()
 draw_foot_here()
 -- for each line
 for y=foot.y,128 do for x=foot.x,128 do
  if pget(x,y) != 0 then -- find the foot
   add(fungus, {
    x=x-1,y=y,l=0, -- record outline
    maxl=fungus_max_length+rnd(6)-3
   }) 
   break
  end
 end end
 cls()
end

function update_fungus()
 for c=0,fungus_grow_speed,100 do
  grow_a_fungus()
 end
end

function grow_a_fungus()
 if rnd(100)<fungus_grow_speed then
  f = choose(fungus)
  if f.l<f.maxl then
   f.l += 1
  end
 end
end

function cut_fungus(x,y)
 x = flr(x-foot.offx)+1
 y = flr(y-foot.y-foot.offy)
 f = fungus[y]
 if (not f) return
 y = f.y+foot.offy
 cut = false
 for fx=f.x-f.l,x do
  cut = true
  c=choose(fungus_colors)
  ac=pget(x,y)
  for fc in all(fungus_colors) do
   if fc==ac then
    c=ac
    break
   end
  end
  add(particles,
   make_particle(
    fx,y,
    -rnd(1.5)-1,rnd(2)-1,
    c,1,0,
    function(self)
     add_to_meter('yeast',1)
    end
   ) -- add die function to add to cauldron
  )
 end
 if(cut)f.l = flr(f.x-x)
 
end

function draw_fungus()
 --srnd(fungus_seed)
 foreach(fungus, draw_a_fungus)
 --unsrnd()
 --print(#fungus, 0,0,7)
end

function draw_a_fungus(f)
 x=f.x+foot.offx
 y=f.y+foot.offy
 if f.l > 0 then
  line(x,y,x-f.l,y,10)
 end
 srnd(fungus_seed+f.y)
 for p=x-f.l,x do
  r = rnd(6)
  if r>5.5 then
   pset(p,y,3)
  elseif r>4 then
   pset(p,y,11)
  end
 end
 unsrnd()
end

-- get fungus string at y coord lvl
-- or nil
function get_fungus(y)
 y = flr(y-foot.offy)
 if(y < 1 or y > #fungus) return nil
 return fungus[y]
end


-- blood particles
function make_blood_fountain(x,y,dx,dy,n,hp)
 return {
  x=x,
  y=y,
  dx=dx or 0,
  dy=dy or 0,
  n=n or rnd(5),
  hp=hp or 100,
  drain=1,
  update=function(self)
   x = self.x + foot.offx
   y = self.y + foot.offy
   if self.hp > 0 and rnd(100)<self.n then 
    for i=0,self.n,100 do
     add(particles, 
      make_particle(
       x,y,
       self.dx*(rnd(.5)+1),
       self.dy*(rnd(.5)+1),
       8,1,0,
       function(self)
        add_to_meter('blood',1)
       end
    ))
    end
   end
   self.hp-=self.drain 
  end,
  draw=function(self)
   x = self.x + foot.offx
   y = self.y + foot.offy
   pset(x,y,8)pset(x+1,y+1,8)pset(x+1,y+2,8)
  end
 }
end

-- particle generator
function init_particle_gen()
 particles = {}
end

function update_particle_gen()

   for d in all(particles) do
    d:update()
    if d.hp<=0 then 
     del(particles, d)
    end
   end
end
function draw_particle_gen()
 for d in all(particles) do
  d:draw()
 end
end

-- particle
function make_particle(x,y,dx,dy,
                       c,hp,drain,
                       die_func)
 return {
  x=x, y=y,
  dx=dx, dy=dy,
  c=c,
  dec=.8,
  hp=hp,
  drain=drain,
  dead=false,
  die=die_func or function()end, -- empty function on default
  update=function(self)
   self.dx*=self.dec
   self.dy+=grav
   self.dy*=self.dec
   self.x+=self.dx 
   self.y+=self.dy
   --debug.f=function()print(self.dy,0,self.y,7)end
   if self.y >= lvl[lvl.current].bottom then
    self.hp=0
   end
   if self.hp <= 0 then
    if not self.dead then 
     self:die()
    end
    self.dead=true 
   end

   self.hp-=self.drain
  end,
  draw=function(self)
   pset(self.x,self.y,self.c)
  end
 }
end

-- foot knife
function init_knife1()
 knife1={
 x=64,
 dx=0,
 max_dx=3,
 start_y=10,
 y=10,
 dy=0,
 max_dy=.9,  --.7
 h=30,
 speedy=.08,
 speedx=.4,
 falling=false,
 raising=true,
 left=false} 
end

function update_knife1()
 bl=btn(0)
 br=btn(1)
 k=knife1
 
 -- move left/right
 if bl then
  if (not k.left) k.dx=0
  k.left = true
  k.dx -= k.speedx
 elseif br then
  if (k.left) k.dx=0
  k.left = false
  k.dx += k.speedx
 else  -- no btn pressed 
  k.dx = 0
 end

 k.dx = mid(-k.max_dx, k.dx, k.max_dx)
 k.x = k.x+k.dx
 k.x = mid(8,120,k.x)


 -- change this later
 if btnp(4) and not k.raising then
  k.falling = true
 end

 -- move down
 if k.falling then
  k.dy = min(k.dy+k.speedy, 
             k.max_dy)
  k.y += k.dy
 elseif k.raising then
  if(wood.was_cut)wood:flip()
  wood.was_cut = false
  k.dy = max(k.dy-k.speedy*6,
             -k.max_dy*6)
  k.y += k.dy
 end

 if k.y >= lvl[1].bottom then 
  k.raising = true
  k.falling = false
 elseif k.y <= k.start_y then
  if wood_flipped == 2 and k.raising then 
   init_wood()
  end
  k.raising = false
  k.dy = 0.2
 end

 --debug.f=function()print(k.dy,0,0)end



 -- collision
 if(k.raising)return -- no collisions when raising

 -- fungus strip
 -- fs = get_fungus(k.y)
 -- if (not fs) return
 -- lp = flr(fs.x-fs.l+foot.offx)
 -- rp = flr(fs.x+foot.offx)
 -- debug = {f=function()line(lp,k.y,rp,k.y,8)end}

 -- if flr(k.x)>rp then  -- hurt
 --  foot.dx = foot.max_dx
 -- elseif flr(k.x)>=lp then -- cut
 -- end

 --if phit_colors(k.x,k.y, {3,10,11}) then -- cut
 -- cut_fungus(k.x,k.y)
 --elseif
 if k.x < 64 then
  cut_wood(x,y-2)
  cut_wood(x,y-1)
  cut_wood(x,y)
  return
 end
 if phit_colors(k.x,k.y, {4,15}) then -- hurt
  cut_foot(k.x,k.y)
 else 
  cut_fungus(k.x,k.y-2)
  cut_fungus(k.x,k.y-1)
  cut_fungus(k.x,k.y)

 end
end

function draw_knife1()
 x=knife1.x
 y=knife1.y
 h=knife1.h
 fulcrum = {x=64,y=-h*4}
 ux,uy = unit(x-fulcrum.x, y-fulcrum.y)
 ux*=h
 uy*=h
 hx=x-ux
 hy=y-uy

 -- metal
 circ(hx,hy, 2, 6)
 for lx=hx-2,hx+2 do
  o = (t+lx)%50<1 and 1 or 0
  line(x,y,lx,hy,6+o)
 end
 --handle
 rectfill(hx-1,hy-1,
          hx+1,hy+1, 4)
 c = 5+(t%8)/4
 pset(x,y,c)

end

-- beer meter
function init_meter()
 meter = {
  levels = {
   blood = {
    ideal=9,
    edge=200,
    10,9,4,2,8,
    amt=0
   },
   yeast = {
    ideal=500,
    edge=1000,
    9,15,10,11,3,
    amt=0
   },
   grain = {
    ideal=50,
    edge=100,
    12,13,10,6,5,
    amt=0
   }
  }
 }
end

function update_meter()
 
end

function add_to_meter(label, amt)
 meter.levels[label].amt += amt
 --debug.f=function()print(meter.levels[label].amt)end
end

-- labelc = {'label', color}
-- x,y centered
-- flip arrow
-- width
function draw_meter(labelc,x,y,fh,w,h)
 label=labelc[1]
 lc=labelc[2] or 6
 w=w or 5
 h=h or 80
 m = meter.levels[label]
 xc=x-w/2
 yc=y-h/2
 fy=min(h/m.edge * m.amt,h)
 c = get_arr_section(m, m.edge, m.amt)
 grace = m.edge*.05 -- 5%
 ac = {6,7} -- arrow color
 optimal = m.ideal > m.amt-grace and -- within grace
           m.ideal < m.amt+grace
 if optimal then 
  ac= {9,10}
 end
 py = yc+h-fy

 --fill
 rect(xc-1,yc,xc+w+2,yc+h+1,5)
 rect(xc-1,yc,xc+w+2,yc+h+1,5)

 rectfill(xc+1,yc+h,
          xc+w,py,c)
 --border
 rect(xc,yc,xc+w+1,yc+h,7)
 --label
 lx=x-1
 ly=y-3*(#label+1)-2
 for i=1,#label do
  dc=lc
  if((t+i-1+x/3)%30<2)dc=7
  l = sub(label,i,i)
  print(l,lx,ly+i*6+1,1)
  print(l,lx+1,ly+i*6,5)
  print(l,lx-1,ly+i*6,5)
  print(l,lx,ly+i*6,dc)
 end
 -- marker
 pset(xc,py,8)
 pset(xc+w+1,py,8)

 --arrows
 if optimal then
  ax=xc + sin((t+x/4)/16)*2 - 3
 else
  ax=xc + sin((t+x/4)/69) - 3
 end
 aw=3
 ay=yc+h-h/m.edge * m.ideal
 if fh then
  ax+=w+aw*2+1
  line(ax,ay+1,ax-aw,ay,ac[1])
  line(ax,ay-1,ax-aw,ay,ac[2])
  line(ax,ay,ax-aw,ay,ac[2])
 else
  line(ax,ay+1,ax+aw,ay,ac[1])
  line(ax,ay-1,ax+aw,ay,ac[2])
  line(ax,ay,ax+aw,ay,ac[2])
 end

end


-- helpers

-- distance between 2 points
-- scaling first to reduce chance of overflow
function distance(x1,y1,x2,y2)
 dx = abs(x2-x1)
 dy = abs(y2-y1)
 d = max(dx,dy)
 n = min(dx,dy)/d
 return sqrt(n*n+1) * d
end

-- normal of a direction
function unit(dx,dy)
 d = distance(0,0,dx,dy)
 return dx/d, dy/d
end


function srnd(v)
 old_seed = rnd(128) + game_started_at + t
 srand(v)
end

function unsrnd()
 srand(old_seed)
end

function choose(arr)
 return arr[flr(rnd(#arr)+1)]
end

function get_arr_section(arr, limit, i)
 return arr[min(flr(#arr/limit * i)+1, #arr)]
end

function all_to_color(c)
 for i=0,15 do
  if c then
   pal(i,c)
  else
   pal(i)
  end
 end
end


-- checks screen coord color
-- return it's within the colors arr
function phit_colors(x,y, colors)
 c = pget(flr(x),flr(y))
 for hc in all(colors) do
  if c == hc then
   return true
  end
 end
 return false
end

function intersects_point_box(px,py,x,y,w,h)
 return flr(px)>=flr(x) and flr(px)<flr(x+w) and
        flr(py)>=flr(y) and flr(py)<flr(y+h)
end

-- hex
hex_chrs = '0123456789abcdef'
chr_2_int = {}
int_2_chr = {}
for ci=1,16 do
 c = sub(hex_chrs,ci,ci)
 int_2_chr[ci-1] = c
 chr_2_int[c] = ci-1
end
function c2i(c)
 return chr_2_int[c]
end
function int_at(str, i)
 return c2i(sub(str,i,i))
end
function i2c(i)
 return int_2_chr[i]
end

--experimental graphics packing
function unpack_graphics(str, w)
 m = {}

 for i=0,#str-1 do
  x=i%w
  y=flr(i/w)
  if x==0 then
   add(m,{})
  end
   add(m[y+1],int_at(str, i+1))
 end
 m.w = w
 m.h = #m
 return m
end

function draw_graphics(gfx,sx,sy,sw,sh, --scale w/h
                       fh,fv,trans_c) --flip h/v, transparent color
 sw,sh=sw or 1,sh or 1
 fh,fv=fh or false,fv or false
 trans_c=trans_c or 0
 if fh then
  sx+=gfx.w*sw
  sw=-sw
 end
 if fv then 
  sy+=gfx.h*sh
  sh=-sh
 end
 
 for gy=1,gfx.h do for gx=1,gfx.w do 
  c = gfx[gy][gx]
  if c!=trans_c then
   rectfill(sx+gx*sw+sw,
            sy+gy*sh+sh,
            sx+gx*sw,
            sy+gy*sh,
            c)
  end
 end end
end

-- flips on horizontal
function flip_graphics(gfx)
 for y=1,gfx.h do 
  tr={}
  for x=1,gfx.w do 
   tr[(gfx.w-x)+1]=gfx[y][x]
  end
  gfx[y]=tr
 end
end

--/bbs/?tid=28374
orf=rectfill
function rectfill(x0,y0,x1,y1,...)
if (x0>x1) x0,x1=x1,x0
if (y0>y1) y0,y1=y1,y0
orf(x0,y0,x1,y1,...)
end


__gfx__
000000000004ffff0000000000000000000000000000000000000000000900000776600000000000000000000005500000000000000000000000000000000000
00000000004ffffff000000000000000090000000000000000000000000900007700660000000000000000000550055000000000000000000000000000000000
0070070004ffff366000000000000000099000000000000000000000009900007070060000000000055555505500005500000000000000000000000000000000
0007700004ffff36d600000000000000099900000000000000000000009900006000060000000000550000550000000000000000000000000000000000000000
000770004ffffff6d600000000000000099990000000066666000000099900006600660000777700000000000000000000000000000000000000000000000000
007007004ffffffd6600000000000000009999000066666656666000999900000066600007777770000000000000000000000000000000000000000000000000
000000004ffffffdd600000000000000009999966666665566606669909000000000000007777770000000000000000000000000000000000000000000000000
00000000044ffffffff0000000000000000900999666565666566999099000000000000000777700000000000000000000000000000000000000000000000000
00000000004fffffffff000000000000000999996566665666656909990000006566665611111111555555550000000000000000000000000000000000000000
0000000000044ffffffff00000000000000009996666656666656999900000005666656615555555665555550000000000000000000000000000000000000000
000000000000444fffff555000000000000069966666656666666999900000006666656615555555566655550000000000000000000000000000000000000000
0000000000004ffffffff00000000000000066666666666666666669600000006666566615555555555555550000000000000000000000000000000000000000
000000000004ffffff4555000000000000006666fff6665666ff6606600000006665666615556666555555550000000000000000000000000000000000000000
00000000004ffffffffff5000000000000006666fffffffffffff666600000006665666615556555555666550000000000000000000000000000000000000000
0000000004fffffffff55500000000000000000fffffffffffffff66600000006656666515556555555556660000000000000000000000000000000000000000
0000000004ffffffffff505000000000000000ff55555fff55555fff500000006566665615556555555555550000000000000000000000000000000000000000
0000000004ffffffffff000000000000000000f55fff55f55fff55ff550000001666665655555555155555550000000000000000000000000000000000000000
0000000004fffffffffff00000000000000000fff111fffff111ffff55000000d666656655555555165555550000000000000000000000000000000000000000
0000000004ff4ffffffff000000000000000000ff711fffff117ffff550000001666656655666655166655550000000000000000000000000000000000000000
0000000004f44fffffffff00000000000000000ff777fffff777ffff50000000d666566655655655155555550000000000000000000000000000000000000000
0000000004f44fffffffff00000000000000000ffffffffffffffff5550000001665666655655655155555550000000000000000000000000000000000000000
00000000004f44fffffff555000000000000000fffff55f555fffff555000000d665666655666655155666550000000000000000000000000000000000000000
000000000004f4fffffff50000000000000000555f555ffff5555ff5550000001656666555555555155556660000000000000000000000000000000000000000
000000000004fffffffffff00000000000000555555f000000f5555555000000d566665655555555155555550000000000000000000000000000000000000000
0000000000004fffffff5555550000000000055555fff0000fff5555500000006566665600000000555555550000000000000000000000000000000000000000
0000000000004fffffffffff05000000000005555555555555555555500000005666656600000000665555550000000000000000000000000000000000000000
0000000000004fffffffffff55000000000000555555555555555555000000006666656600000000566655550000000000000000000000000000000000000000
0000000000004ffffffffffff0000000000000556555556556556550000000006666566600000000555555550000000000000000000000000000000000000000
0000000000004ffffffffffffff00000000000055565555555555555000000006665666600000000555555550000000000000000000000000000000000000000
0000000000004fffffffffffffff0000000000055556565556555655000000006665666600000000555666550000000000000000000000000000000000000000
0000000000004fffffffffffffff0000000000005555555555555555000000006656666500000000555556660000000000000000000000000000000000000000
0000000000004fffffffffffffff000000000000555655555555555000000000d1d1d1d100000000111111110000000000000000000000000000000000000000
00000000000004ffffffffffffff0000000000005555655565565550000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004ffffffffffffff0000000000000555555565565500000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004ffffffffffffff0000000000000555555555555500000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004ffffffffffffff0000000000000055565555565500000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004ffffffffff4f440000000000000005555556555000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000004fffffffffffffff0000000000000005555655550000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000004fffffffffffffff0000000000000005655555550000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000004fffffffffffffff0000000000000000555556500000000000000000000000000000000000000000000000000000000000000000000000000000
000000000004ffffffffffffffff0000000000000000555555500000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffffffffffff444f0000000000000000055655500000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffffffffffff44440000000000000000005555000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004ffffffff2fffff4440000000000000000000555000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004fffffffff2ffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004fffffffff222ffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ffffffffff222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004fffffffffff222fffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004fffffffffffff2222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004fffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004ffffffffffff4ffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffffffffff444fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffffffffff4444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000004fffffffff44400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000444f4444f444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000044444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004444444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
011000001f0501f0501d0511a05118051180501c051150511c057130501c0501d0501000010000100001000010000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344

